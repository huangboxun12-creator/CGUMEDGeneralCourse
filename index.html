<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é•·åºšé†«å­¸ç³»é€šè­˜å¿ƒå¾—ç¶²</title>
    <style>
        /* ç¹¼æ‰¿ everyclass.css é¢¨æ ¼ */
        body { background-color: #f0f2f5; font-family: sans-serif; display: flex; flex-direction: column; align-items: center; padding: 20px; }
        .label_title { font-size: 25px; font-weight: bold; width: 95%; max-width: 600px; text-align: center; color: black; background-color: #87e967; padding: 15px; border-radius: 10px; border: 3px solid #000; margin: 10px 0; }
        .label_info { font-size: 18px; font-weight: bold; width: 95%; max-width: 600px; text-align: center; color: black; background-color: #fddb69; padding: 10px; border-radius: 10px; border: 3px solid #000; margin: 10px 0; }
        .label_comment { font-size: 16px; width: 95%; max-width: 600px; background-color: #ffffff; border-radius: 10px; padding: 15px; border: 3px solid #000; margin-bottom: 15px; text-align: left; }
        .btn_menu { font-size: 18px; font-weight: bold; width: 95%; max-width: 600px; background-color: #7edcfc; border-radius: 10px; padding: 15px; border: 3px solid #000; cursor: pointer; box-shadow: 3px 3px 3px #29c6fa; margin: 8px 0; }
        .btn_back { background-color: #bbb; box-shadow: 3px 3px 3px #888; width: auto; min-width: 120px; margin-bottom: 20px; }
        .layer { display: none; width: 100%; flex-direction: column; align-items: center; }
        .active { display: flex; }
        .course-detail { font-size: 0.9rem; color: #555; text-align: left; background: #eee; padding: 10px; border-radius: 5px; margin-bottom: 10px; border-left: 5px solid #003a6c; }
    </style>
</head>
<body>

    <div class="label_title">é•·åºšé†«å­¸ç³»é€šè­˜å¿ƒå¾—ç¶² ğŸ“š</div>

    <main style="width: 100%; display: flex; flex-direction: column; align-items: center;">
        
        <div id="layer1" class="layer active">
            <div class="label_info">è«‹é¸æ“‡é¡åˆ¥</div>
            <button class="btn_menu" onclick="showLayer2('æ ¸å¿ƒ')">æ ¸å¿ƒé€šè­˜</button>
            <button class="btn_menu" onclick="showLayer2('å¤šå…ƒ')">å¤šå…ƒé€šè­˜</button>
        </div>

        <div id="layer2" class="layer">
            <button class="btn_menu btn_back" onclick="switchLayer(1)">â¬…ï¸ è¿”å›é¦–é </button>
            <div id="layer2_title" class="label_info"></div>
            <div id="sub_cat_container"></div>
        </div>

        <div id="layer3" class="layer">
            <button class="btn_menu btn_back" onclick="switchLayer(2)">â¬…ï¸ è¿”å›é ˜åŸŸ</button>
            <div id="layer3_title" class="label_info"></div>
            <div id="course_list_container"></div>
        </div>

        <div id="layer4" class="layer">
            <button class="btn_menu btn_back" onclick="switchLayer(3)">â¬…ï¸ è¿”å›æ¸…å–®</button>
            <div id="final_title" class="label_title"></div>
            <div id="course_info_box" class="label_comment"></div>
            <div id="reviews_container"></div>
        </div>

    </main>

<script>
// --- é è¼‰èª²ç¨‹è³‡æ–™ (å¾ä½ çš„ Sheet è¤‡è£½æ•´ç†) ---
const courseData = {
    "æ ¸å¿ƒ": {
        "è—è¡“èˆ‡äººæ–‡æ€ç¶­": [
            { id: "A2826", name: "æ­ŒåŠ‡èˆ‡æ­ŒåŠ‡é™¢", teacher: "å»–å©‰å¦‚", credit: 2, info: "éŸ³æ¨‚èˆ‡è¡¨æ¼”è—è¡“çµåˆä¹‹ä»‹ç´¹...", grading: "å‡ºå¸­20%, æœŸä¸­30%, æœŸæœ«50%" },
            { id: "A2827", name: "ç¾ä»£è©©èˆ‡ç•¶ä»£æ–‡åŒ–", teacher: "å‘é™½", credit: 2, info: "ç¾ä»£è©©å‰µä½œèˆ‡ç¤¾æœƒæ–‡åŒ–äº’å‹•...", grading: "å‡ºå¸­10%, å ±å‘Š30%, æœŸæœ«60%" }
        ],
        "å…¬æ°‘èˆ‡ç¤¾æœƒæ¢ç©¶": [
            { id: "A2846", name: "é†«å­¸èˆ‡æ³•å¾‹", teacher: "é™³ä»²éš†", credit: 2, info: "æ³•å¾‹åŸºæœ¬æ¦‚å¿µèˆ‡é†«ç™‚ç³¾ç´›æ¡ˆä¾‹...", grading: "æœŸæœ«è€ƒ100%" },
            { id: "A2837", name: "è‡ºç£å²", teacher: "è”¡é¾ä¿", credit: 2, info: "å°ç£æ­·å²æ¼”é€²èˆ‡æ–‡åŒ–ç‰¹è‰²...", grading: "å€‹äººä½œæ¥­50%, æœŸæœ«è€ƒ50%" }
        ]
    },
    "å¤šå…ƒ": {
        "è‡ªç„¶ç§‘å­¸é ˜åŸŸ": [
            { id: "B1234", name: "ç’°å¢ƒä¿è­·å°è«–", teacher: "ç‹å°æ˜", credit: 2, info: "ç”Ÿæ…‹ç’°å¢ƒèˆ‡æ°¸çºŒç™¼å±•...", grading: "æ¯é€±å¿ƒå¾—40%, æœŸæœ«å ±å‘Š60%" }
        ],
        "ç¤¾æœƒç§‘å­¸é ˜åŸŸ": [
            { id: "B5678", name: "å¿ƒç†å­¸å°è«–", teacher: "å¼µå¤§åƒ", credit: 2, info: "äººé¡è¡Œç‚ºèˆ‡å¿ƒç†æ©Ÿåˆ¶...", grading: "å‡ºå¸­20%, æœŸä¸­40%, æœŸæœ«40%" }
        ]
    }
};

// --- Google Sheet å¿ƒå¾— CSV é€£çµ ---
const csvUrl = "https://docs.google.com/spreadsheets/d/e/2PACX-1vR8cTxUPOSQA1ypJytbZ01-CX5qXM-iXExvbaBOpWATCade5xf3WYsKLrdhbrBOAiegZiefn97HgGlv/pub?gid=313985456&single=true&output=csv";
let allReviews = [];

async function initReviews() {
    try {
        const res = await fetch(csvUrl);
        const text = await res.text();
        const rows = text.split('\n').map(r => r.split(/,(?=(?:(?:[^"]*"){2})*[^"]*$)/)).slice(1);
        allReviews = rows.map(row => ({
            name: (row[5] || row[13] || row[21] || "").replace(/"/g, ''),
            overall: row[7] || row[15] || row[23] || "?",
            sweet: row[8] || row[16] || row[24] || "?",
            comment: (row[12] || row[20] || row[28] || "").replace(/"/g, '')
        }));
    } catch (e) { console.error("å¿ƒå¾—è®€å–å¤±æ•—"); }
}

let currentMain = "";
function showLayer2(main) {
    currentMain = main;
    switchLayer(2);
    document.getElementById('layer2_title').innerText = main;
    const container = document.getElementById('sub_cat_container');
    container.innerHTML = Object.keys(courseData[main]).map(sub => 
        `<button class="btn_menu" onclick="showLayer3('${sub}')">${sub}</button>`
    ).join('');
}

let currentSub = "";
function showLayer3(sub) {
    currentSub = sub;
    switchLayer(3);
    document.getElementById('layer3_title').innerText = sub;
    const container = document.getElementById('course_list_container');
    container.innerHTML = courseData[currentMain][sub].map(c => 
        `<button class="btn_menu" onclick="showFinal('${c.name}')">${c.name} (${c.teacher})</button>`
    ).join('');
}

function showFinal(cName) {
    switchLayer(4);
    const course = Object.values(courseData[currentMain][currentSub]).find(c => c.name === cName);
    document.getElementById('final_title').innerText = cName;
    document.getElementById('course_info_box').innerHTML = `
        <b>æˆèª²æ•™å¸«ï¼š</b>${course.teacher}<br>
        <b>é–‹èª²åºè™Ÿï¼š</b>${course.id} | <b>å­¸åˆ†ï¼š</b>${course.credit}<br>
        <hr>
        <b>èª²ç¨‹ç°¡ä»‹ï¼š</b>${course.info}<br>
        <b>è©•åˆ†æ–¹å¼ï¼š</b>${course.grading}
    `;

    const reviews = allReviews.filter(r => r.name === cName);
    const rContainer = document.getElementById('reviews_container');
    rContainer.innerHTML = reviews.length ? reviews.map(r => `
        <div class="label_info">â­è©•åˆ†: ${r.overall} | ğŸ¬ç”œåº¦: ${r.sweet}</div>
        <div class="label_comment">${r.comment}</div>
    `).join('') : '<div class="label_info">ç›®å‰å°šç„¡å¿ƒå¾—ğŸ« </div>';
}

function switchLayer(n) {
    document.querySelectorAll('.layer').forEach(l => l.classList.remove('active'));
    document.getElementById('layer' + n).classList.add('active');
}

initReviews();
</script>
</body>
</html>
