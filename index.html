<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=2.0" />
    <title>é•·åºšé†«å­¸ç³»é€šè­˜åˆ†äº«å€</title>
    <style>

        /* æ ¸å¿ƒ MMC é¢¨æ ¼åŸºç¤ */
        body { background-color: #eeeeee; font-family: sans-serif; display: flex; flex-direction: column; align-items: center; padding: 20px; margin: 0; }
        #index_frame { width: 100%; max-width: 600px; text-align: center; }

        /* æ¨™é¡Œèˆ‡è³‡è¨Šæ¡† (Neo-Brutalism Style) */
        .label_title { font-size: 25px; font-weight: bold; width: 100%; line-height: 24px; text-align: center; color: black; background-color: #87e967; padding: 15px; border-radius: 10px; border: 3px solid #000; display: block; box-sizing: border-box; margin-bottom: 10px; }
        .label_info { font-size: 18px; font-weight: bold; width: 100%; text-align: center; color: black; background-color: #fddb69; padding: 10px; border-radius: 10px; border: 3px solid #000; margin: 10px 0; display: block; box-sizing: border-box; }

        /* MMC å®¹å™¨æ¨£å¼ */
        .index_choosebox { margin: 10px auto; background-color: #ffffff; padding: 15px; border-radius: 10px; border: 3px solid #000; display: flex; flex-direction: column; align-items: center; box-sizing: border-box; width: 100%; }

        /* æ¨™æº–æŒ‰éˆ•æ¨£å¼ (Layer 1 & 2 ä½¿ç”¨) */
        .btn_home { appearance: none; width: 100%; font-size: 18px; font-weight: bold; text-align: center; color: black; background-color: #7edcfc; border-radius: 10px; padding: 12px; border: 3px solid #000; cursor: pointer; box-shadow: 3px 3px 0px #29c6fa; margin: 8px 0; transition: 0.1s; white-space: pre-wrap; }
        .btn_home:active { transform: translate(2px, 2px); box-shadow: none; }

        /* èª²ç¨‹å°ˆç”¨æŒ‰éˆ•æ¨£å¼ (Layer 3 å°ˆç”¨ï¼Œåƒè€ƒ MMC å¼·èª¿èª²ç¨‹è³‡è¨Š) */
        .btn_course { 
            appearance: none; width: 100%; max-width: 480px; font-size: 18px; font-weight: bold; 
            text-align: center; color: black; background-color: #7edcfc; border-radius: 10px; 
            padding: 12px; border: 3px solid #000; cursor: pointer; box-shadow: 3px 3px 0px #29c6fa; 
            margin: 10px 0; white-space: pre-wrap; transition: 0.1s; display: block;
        }
        .btn_course:active { transform: translate(2px, 2px); box-shadow: none; }

        /* åŠŸèƒ½æŒ‰éˆ• (æˆ‘è¦è²¢ç»æ¨£å¼) */
        .btn_contribution { background-color: #FFD2D7; box-shadow: 3px 3px 0px #d06f79; width: 100%; font-size: 18px; font-weight: bold; padding: 12px; border-radius: 10px; border: 3px solid #000; cursor: pointer; margin-bottom: 15px; display: block; text-decoration: none; color: black; box-sizing: border-box; }

        /* å¿ƒå¾—é¡¯ç¤ºå€ (å¥—ç”¨å­¸é•· label_comment) */
        .label_comment { font-size: 16px; width: 100%; background-color: #ffffff; border-radius: 10px; padding: 15px; border: 3px solid #000; margin-bottom: 15px; text-align: left; box-sizing: border-box; line-height: 1.6; }

        /* é›™é‡å°èˆªçµ„ */
        .nav_group { display: flex; gap: 10px; width: 100%; margin-top: 5px; margin-bottom: 5px; box-sizing: border-box; }
        .nav_group .btn_home { font-size: 16px; background-color: #bbb; box-shadow: 2px 2px 0#777; flex: 1; margin: 0; }
        .nav_group .btn_home_active { background-color: #7edcfc; box-shadow: 2px 2px 0#29c6fa; }

        /* çµæ§‹å±¤ç´šæ§åˆ¶ */
        .layer { display: none; width: 100%; flex-direction: column; align-items: center; }
        .active { display: flex; }

        /* éŸ¿æ‡‰å¼å¾®èª¿ */
        @media screen and (max-width:600px){
            #index_frame { width: 95%; }
            .btn_course, .btn_home, .label_title, .label_info, .index_choosebox, .btn_contribution, .label_comment { width: 100% !important; }
        }
        
    </style>
</head>
    
<body>

<div id="index_frame">
    <label class="label_title">é•·åºšé†«å­¸ç³»é€šè­˜åˆ†äº«å€ ğŸ“š</label>

    <div id="layer1" class="layer active">
        <label class="label_info">è«‹é¸æ“‡é€šè­˜é¡åˆ¥</label>
        <div class="index_choosebox">
            <button class="btn_home" onclick="showLayer2('æ ¸å¿ƒ')">æ ¸å¿ƒé€šè­˜</button>
            <button class="btn_home" onclick="showLayer2('å¤šå…ƒ')">å¤šå…ƒé€šè­˜</button>
        </div>
        <a href="https://forms.gle/6yTjFRWBnxJTjLMT8" target="_blank" class="btn_contribution">âœï¸ æˆ‘è¦æŠ•ç¨¿å¿ƒå¾— (é»æˆ‘)</a>
    </div>

    <div id="layer2" class="layer">
        <div class="nav_group">
            <button class="btn_home" onclick="switchLayer(1)">â¬…ï¸ è¿”å›é¦–é </button>
        </div>
        <label id="layer2_title" class="label_info"></label>
        <div class="index_choosebox" id="sub_cat_container"></div>
    </div>

    <div id="layer3" class="layer">
        <div class="nav_group">
            <button class="btn_home" onclick="switchLayer(2)">â¬…ï¸ è¿”å›é ˜åŸŸ</button>
            <button class="btn_home btn_home_active" onclick="switchLayer(1)">ğŸ  å›é¦–é </button>
        </div>
        <label id="layer3_title" class="label_info"></label>
        <div class="index_choosebox" id="course_list_container"></div>
        <div class="nav_group">
            <button class="btn_home" onclick="switchLayer(2)">â¬…ï¸ è¿”å›é ˜åŸŸ</button>
            <button class="btn_home btn_home_active" onclick="switchLayer(1)">ğŸ  å›é¦–é </button>
        </div>
    </div>

    <div id="layer4" class="layer">
        <div class="nav_group">
            <button class="btn_home" onclick="switchLayer(3)">â¬…ï¸ è¿”å›åˆ—è¡¨</button>
            <button class="btn_home btn_home_active" onclick="switchLayer(1)">ğŸ  å›é¦–é </button>
        </div>
        <label id="final_title" class="label_title"></label>
        <div id="course_info_box" style="width: 100%;"></div>
        <div id="reviews_container" style="width: 100%;"></div>
        <div class="nav_group">
            <button class="btn_home" onclick="switchLayer(3)">â¬…ï¸ è¿”å›åˆ—è¡¨</button>
            <button class="btn_home btn_home_active" onclick="switchLayer(1)">ğŸ  å›é¦–é </button>
        </div>
    </div>

    <p style="font-size: 12px; color: #888; margin-top: 30px;">Coded by huangboxun12 & AI Assistant(Gemini)<br>æœ€å¾Œæ›´æ–°: 2026/02/09</p>
</div>

<script>
// --- é è¼‰èª²ç¨‹è³‡æ–™ (è«‹å°‡æ‚¨çš„ Sheet è³‡æ–™å¡«å…¥æ­¤è™•) ---
const courseData = {
    "æ ¸å¿ƒ": {
        "è—è¡“èˆ‡äººæ–‡æ€ç¶­": [
            
            { id: "A2826", name: "æ­ŒåŠ‡èˆ‡æ­ŒåŠ‡é™¢", teacher: "æ´ªäºæ·³", credit: 3, info: "æ­ŒåŠ‡ç‚ºä¸€é–€çµåˆéŸ³æ¨‚ã€æˆ²åŠ‡ã€èˆè¹ˆã€æœè£ã€è¡¨æ¼”è—è¡“ã€èˆ‡å»ºç¯‰çš„ç¶œåˆè—è¡“ã€‚å°¤å…¶ç•¶æˆ‘å€‘è«‡åˆ°åŠ‡é™¢æ™‚ï¼Œæ›´æ˜¯ä¸èƒ½å¿½ç•¥å®ƒåœ¨å¤å¸Œè‡˜ï¼ˆæ­æ´²çš„éŸ³æ¨‚ç™¼æºåœ°ï¼‰ä¹‹ç”Ÿæ´»ä¸­æ‰€ä½”çš„ç‰¹æ®Šåœ°ä½ã€‚æœ¬èª²ç¨‹å°‡å¾æ­ŒåŠ‡çš„ç™¼å±•éç¨‹ä¸­ï¼Œä¾ç…§ä¸åŒç¨®é¡çš„æ­ŒåŠ‡ä½œå“èˆ‡å…¶æ‰€å±¬çš„æ™‚ç©ºèƒŒæ™¯ï¼Œæœ‰ç³»çµ±åœ°ä»‹ç´¹ç•¶æ™‚æ‰€é©åˆçš„æ¼”å‡ºå ´æ‰€ã€‚", grading: "å°šç„¡è©³ç´°è³‡æ–™" },
            { id: "A2827", name: "ç¾ä»£è©©èˆ‡ç•¶ä»£æ–‡åŒ–", teacher: "åŠ‰å¾·ç²", credit: 3, info: "ç¾ä»£è©©è‡ªäº”å››æ–‡å­¸è®Šé©ä»¥ä¾†ï¼Œç¾ä»£è©©çš„æ„è±¡å ªç¨±é¢¨æƒ…è¬ç¨®ã€åƒå§¿ç™¾æ…‹ï¼Œç¾ä»£è©©çš„åç¨±ã€é¡å‹èˆ‡é¢¨æ ¼å¤šæ¨£ï¼Œå¾ç™½è©±è©©åˆ°æ–°è©©ã€ç¾ä»£è©©ï¼Œè¨±å¤šæ–‡å­¸æ„›å¥½è€…å°æ–¼ç¾ä»£è©©çš„èªè¨€è—è¡“æ„Ÿåˆ°è‰±æ¾€é›£æ‡‚ï¼Œç›¸è¼ƒæ•£æ–‡èˆ‡å°èªªï¼Œé–±è®€è©©çš„äººå£ç›¸å°è¼ƒå°‘ï¼Œæœ¬èª²ç¨‹è¨­è¨ˆä¹‹ç†å¿µèˆ‡ç›®æ¨™ï¼Œåœ¨é€éåå®¶ä½œå“ä¹‹è¬›æˆèˆ‡åˆ†æï¼Œå¼•å°ä¿®èª²å­¸ç”ŸæŒæ¡ç¾ä»£è©©ä¹‹è«¸å¤šé¢è²Œï¼ŒåŸ¹é¤Šæ¬£è³æ‰¹è©•ä½œå“ä¹‹èƒ½åŠ›ï¼Œä¸¦ç¶“ç”±å¯«ä½œèˆ‡è¨è«–ï¼Œé‡å¡‘å­¸ç”Ÿæ–°è©©ç¾å­¸ä¹‹è§€å¿µã€‚èª²ç¨‹æ¡å¾ªåºæ¼¸é€²ã€èª²å ‚è¬›æˆåŠåˆ†çµ„è¨è«–é€²è¡Œï¼Œä¸¦ç¶“ç”±é–±è®€ä½œå“åŸ¹è‚²å­¸ç”Ÿå€«ç†ã€åª’é«”èˆ‡ç¾å­¸ç´ é¤Šï¼Œä»¥ç¬¦åˆæ ¸å¿ƒèƒ½åŠ›åŸºæœ¬ç´ é¤Šï¼Œè—‰ç”±åˆ†æå•é¡Œèˆ‡æ¬£è³æ–‡è—ï¼Œæå‡å€‹äººå°æ–‡å­¸è—è¡“çš„çŸ¥æ€§å’Œæ„Ÿæ€§èƒ½åŠ›ã€æŒæ¡èªæ–‡è¡¨é”èƒ½åŠ›ã€å…·å‚™æ€è¾¨çš„å…§æ¶µå’Œèƒ½åŠ›ç­‰ã€‚", grading: "å°šç„¡è©³ç´°è³‡æ–™" },
            { id: "A2846", name: "å¯“è¨€-ç¶“å…¸èˆ‡å¤šå…ƒæ€ç¶­", teacher: "éŸ“å­¸å®", credit: 3, info: ""å¯“è¨€æ˜¯ä½œè€…å¦æœ‰å¯„æ‰˜çš„æ•…äº‹ã€‚ï¼ˆé™³è’²æ¸…èªï¼‰æ˜¯ä¸€åªç²¾æ‚çŸ­å°çš„æ•…äº‹ï¼Œåœ¨æ•…äº‹è£ï¼Œå€Ÿè‘—é£›ç¦½èµ°ç¸ã€é­šé±‰æ˜†èŸ²çš„æ€§è³ªèˆ‡è¡Œå‹•ï¼Œç”šè‡³æ–¼èªè¨€ï¼Œè€Œå¼•èµ·æŸäº›åæ‡‰ï¼Œä»¥æš´éœ²äººé¡çš„ç‰¹å¾µæŠ‘å¼±é»ï¼Œæ•…å…¶å…§æ¶µæ˜¯å¾®å…·è«·åˆºã€å•Ÿç¤ºæ€§å’Œé€æ‚Ÿæ€§çš„ã€‚è“‹è¨€ä¹‹å‡ºæ–¼ä¸€å·±ï¼Œå‰‡äººå¾®è¨€è¼•ï¼Œæ•…æ‰˜å£ä»–äººä»–ç‰©ä¹‹è¨€ä»¥ç«‹æ„ç„‰ï¼Œå‰‡æ˜“ç”Ÿå‹¸èª¨ä¹‹æ•ˆã€‚ï¼ˆä¸€ï¼‰æœ¬èª²ç¨‹å³è©¦åœ–é€éä»‹ç´¹å…ˆç§¦ä»¥ä¾†å„æœŸçš„å¯“è¨€ï¼Œä»¥æ˜ç­å¤å“²æ‰€è¦å‚³é”çµ¦æˆ‘å€‘çš„æ™ºæ…§ã€‚ï¼ˆäºŒï¼‰é€éå¯“è¨€å…·é«”æ•…äº‹ï¼Œå¸¶å‡ºä¸»å®¢äººç‰©çš„ä¸åŒè§’åº¦èˆ‡åƒ¹å€¼è§€ï¼Œè®“åŒå­¸èƒ½å­¸æœƒç†è§£ä¸åŒè§’åº¦çš„çœ‹æ³•ï¼Œé€²è€Œå°Šé‡ä¸åŒçš„çœ‹æ³•ã€‚"", grading: "å°šç„¡è©³ç´°è³‡æ–™" },
            { id: "A2499", name: "å€«ç†èˆ‡ç¾å­¸ï¼šé›»å½±èˆ‡æˆ²åŠ‡ä¸­çš„èå£«æ¯”äº", teacher: "é„­æƒ èŠ³", credit: 3, info: ""é‡è¦èª²ç¨‹å…¬å‘Š: æœ¬èª²ç¨‹åŸ·è¡Œæ•™è‚²éƒ¨æ•™å­¸å¯¦è¸ç ”ç©¶è¨ˆç•«ï¼Œä¿®èª²å­¸ç”Ÿå°‡å—é‚€æˆç‚ºç ”ç©¶åƒèˆ‡è€…ï¼Œä»¥å”åŠ©èª²ç¨‹æˆæ•ˆè©•ä¼°ã€‚èª²ç¨‹çµåˆèå£«æ¯”äºæ–‡å­¸èˆ‡è¡¨é”è—è¡“æ²»ç™‚ï¼Œå¹«åŠ©å­¸ç”Ÿæå‡æƒ…ç·’å¥åº·èˆ‡è‡ªæˆ‘è¦ºå¯Ÿã€‚å­¸ç”Ÿå°‡é€éè§’è‰²æ‰®æ¼”ã€è‚¢é«”å‹•ä½œèˆ‡å‰µæ„è¡¨é”ï¼Œæ·±å…¥æ¢ç´¢æ–‡æœ¬ä¸­çš„æƒ…æ„Ÿä¸–ç•Œã€‚èª²ç¨‹ä»¥è‹±èªæˆèª²ï¼Œä¸¦æä¾›ä¸­æ–‡æ”¯æ´ï¼Œå”åŠ©å­¸ç”Ÿç†è§£åŸæ–‡ä¸¦è‡ªç”±è¡¨é”ã€‚"", grading: "å°šç„¡è©³ç´°è³‡æ–™" },
            { id: "A2500", name: "æ­ç¾æˆ²åŠ‡", teacher: "é»ƒå°¹ç‘©", credit: 3, info: "æˆ²åŠ‡æ˜¯ä¸€ç¨®å¤šé‡‡å¤šå§¿, ä»¥äººç‚ºä¸»é«”çš„è—è¡“å½¢å¼, ä¸ä½†åæ˜ å„ç¨®æ–‡åŒ–å’Œæ™‚ä»£çš„æ€æƒ³å’Œç¾å­¸, ä¸”èƒ½è¡¨é”è±å¯Œçš„äººé¡æƒ…æ„ŸåŠå‚³éå„ç¨®å¯¶è²´çš„äººç”Ÿç¶“é©—ã€‚ æœ¬èª²ç¨‹æœŸé€éå°æ­ç¾æˆ²åŠ‡çš„ä»‹ç´¹, ä»¥èª²å ‚è¬›æˆå’Œé–±è®€ç¶“å…¸æˆ²åŠ‡åŠ‡æœ¬, æ–‡å­—å’Œå½±åƒè³‡æ–™, å°çµ„è¨è«–, åŠæˆ²åŠ‡ç­‰æ´»å‹•, å¼•é ˜å­¸ç”Ÿèªè­˜æ­ç¾æˆ²åŠ‡é¢¨æ ¼åŠå…¶çµ„æˆæˆä»½, å¢åŠ å­¸ç”Ÿæ¬£è³è¥¿æ–¹æ–‡åŒ–åŠæ­ç¾æˆ²åŠ‡çš„ç¾æ„Ÿç¶“é©—ã€‚", grading: "å°šç„¡è©³ç´°è³‡æ–™" },
            { id: "A2501", name: "åŒ—ç¾å°èªªã€æŠ€è—èˆ‡æ€§åˆ¥è§’è‰²", teacher: "è‘‰ç‰æ…§", credit: 3, info: "æœ¬èª²ç¨‹æ˜¯ç”±å…­ã€‡è‡³ä¸ƒã€‡å¹´ä»£å´›èµ·çš„ç¬¬äºŒæ³¢å¥³æ€§ä¸»ç¾©è€…æ‰€æå‡ºçš„è«–è¿°åˆ‡å…¥ã€‚è©²è«–è¿°å¾ç¤¾æœƒå­¸çµ±è¨ˆçš„æ•¸æ“šèˆ‡å°åª’é«”çš„è§€æŸ¥ï¼Œå°‡å®¶åº­è¦–ç‚ºæ˜¯äºŒåä¸–ç´€åˆè‡³ä¸­æœŸçš„å¥³æ€§è¢«æŸç¸›çš„è±¡å¾µï¼Œå½¢æˆç¤¾æœƒä¸Šå¥³æ€§æ¬Šç¾©æ˜é¡¯å’Œç”·æ€§ä¸å¹³ç­‰çš„æƒ…æ³ã€‚å› æ­¤ï¼Œå…«ã€‡å¹´ä»£é–‹å§‹ï¼Œå¥³æ€§ç‚ºäº†çˆ­å–èˆ‡ç”·æ€§ç¤¾æœƒåœ°ä½å¹³ç­‰åŒ–ï¼Œä¸æ–·ææ˜‡å­¸æ­·ï¼ŒåŠªåŠ›åœ¨è·å ´ä¸Šæ›´æœ‰æˆå°±ã€‚åœ¨ç”·æ€§èˆ‡å¥³æ€§åœ¨å·¥å•†ã€æ”¿æ²»ç•Œå¹³èµ·å¹³åçš„èƒŒæ™¯ä¸‹ï¼Œä¸€èˆ¬å‚³çµ±è§€å¿µæ‰€èªç‚ºå¥³æ€§åŒ–çš„æŠ€è—ï¼Œä¾‹å¦‚ï¼šç·¨ç¹”ã€æ‰“æ¯›ç·šã€ç¸«ç´‰ã€çƒ¹é£ªã€æ‰“æƒã€å±…å®¶å¸ƒç½®ç­‰å±¬æ–¼ã€Œå®¶åº­ã€æ€§è³ª (domestic skillsï¼‰ çš„ç”Ÿæ´»å–œå¥½å°±è¢«æ­¸é¡ç‚ºã€Œå‡ºä¸äº†å»³å ‚ã€å’Œè½ä¼ã€‚æ‰€ä»¥ï¼Œç•¶æ™‚è·æ¥­å©¦å¥³å¦‚å–œå¥½çƒ¹é£ªã€æ‰“æ¯›ç·šç­‰ï¼Œé€šå¸¸ä¸å¸Œæœ›åˆ¥äººçŸ¥é“ã€‚ä½†æ˜¯åˆ°äº†ä¹ã€‡å¹´ä»£ï¼Œå› ç‚ºåª’é«”çš„é—œï¼Œå°å¥³æ€§åœ¨ç¤¾æœƒä¸Šçš„è§’è‰²å’ŒæˆåŠŸçš„é€”å¾‘åˆæœ‰äº†ä¸åŒçš„çœ‹æ³•ã€‚é‚£å°±æ˜¯å› ç‚ºå…©ä½æˆåŠŸç¾åœ‹å¥³æ€§çš„å´›èµ·ï¼šç‘ªè â€¢ å²éƒ½è¯ (Martha Stewartï¼‰ èˆ‡æ­æ™®æ‹‰ â€¢é›¯æ–çˆ¾ (Oprah Winfrey)ã€‚å¥¹å€‘ä»£è¡¨çš„æ˜¯ç›¸åŒæ–¼ç”·æ€§åœ¨å·¥å•†ç•ŒæˆåŠŸçš„ä¾‹å­ï¼Œå»åŒæ™‚é¼“å‹µå¥³æ€§æ“æŠ±å±¬æ–¼å¥³æ€§åŒ–çš„æŠ€è—ã€‚äºŒåä¸–ç´€æœ«è‡³äºŒåä¸€ä¸–ç´€åˆæœŸï¼Œåœ¨åŒ—ç¾å‡ºç‰ˆæœ‰é—œæ–¼å¥³æ€§åŒ–æŠ€è—çš„è«–è¿°èˆ‡æ–‡æœ¬æ¼¸æ¼¸å¢åŠ ã€‚åœ¨2003å¹´ä¸€ä½é ‚è‘—è€¶é­¯å¤§å­¸å¿ƒç†å­¸åšå£«é ­éŠœçš„å¥³æ€§é»›æ¯”â€¢å²å¤šå‹’ (Debbie Stollerï¼‰ å‡ºç‰ˆäº†ä¸€æœ¬æ¯›ç·šæ‰‹è—æ›¸ã€‚å¥¹åœ¨é€™æœ¬æ›¸ä¸­è©¦åœ–å¾æ‰“æ¯›ç·šçš„æ´»å‹•ä¸­ï¼Œé‡å¿ƒæ€è€ƒå¥³æ€§ä¸»ç¾©ä¸»æµæ€æ½®å°å¥³æ€§åŒ–æŠ€è—çš„æ­§è¦–ã€‚", grading: "å°šç„¡è©³ç´°è³‡æ–™" },
            { id: "A2847", name: "å“²å­¸èˆ‡æ–‡åŒ–", teacher: "é‚¸å½¥", credit: 3, info: ""å“²å­¸philo-sophiaï¼Œå°±æœ¬è³ªè€Œè¨€å³ç‚ºæ„›æ™ºæ…§ä¹‹å­¸ã€‚çœŸæ­£çš„å“²å­¸æ©«è·¨å¤šå…ƒé¢å‘ï¼šä»¥ç¾æœ‰çš„æ–‡åŒ–ç´¯ç©å’Œç”Ÿæ´»ä¸–ç•Œç‚ºèµ·é»èˆ‡ç´ æï¼Œä»¥ç¸å¯†æ€è¾¯èˆ‡ç„¡ç›¡åæ€ç‚ºæ–¹æ³•ï¼Œä»¥å……æ»¿å¥½å¥‡çš„æ„›ç‚ºå‹•åŠ›ï¼›ä»¥èª¿å’Œæ¿€æƒ…èˆ‡ç†æ€§ï¼Œä¹ƒè‡³ç”Ÿå‘½è«¸å…ƒä¹‹é–“çš„ç´›æ“¾ï¼Œæœ€çµ‚æˆå°±æ•´é«”å’Œè«§çš„æ™ºæ…§ä¹‹å­¸ã€‚å› æ­¤ï¼Œæœ¬èª²ç¨‹è¨­è¨ˆå‹™æ±‚åŒæ™‚æŠŠæ¡å…§å¤–å…©å…ƒï¼šä¸€æ–¹é¢ï¼Œæ“´å¤§æ–‡åŒ–è¦–é‡çš„å»£åº¦ï¼Œç‚ºåæ€å·¥ä½œæä¾›ææ–™å’ŒåŸºç¤ï¼›åŒæ™‚ï¼ŒæŠŠæ¡å“²å­¸çš„æ•´é«”æ€§å’Œæœ€çµ‚ç›®çš„â€”â€”å³æ„›èˆ‡æ™ºæ…§çš„çµåˆã€‚æ­¤å¤–ï¼Œç‚ºäº†å¼·åŒ–å­¸ç”Ÿçš„ç”Ÿæ´»ç¶“é©—å’Œæ€è¾¨èƒ½åŠ›ï¼Œèª²ç¨‹é™¤äº†èª²å ‚æ•™å­¸å¤–ï¼Œé‚„å°‡é€šéç¶“å…¸æ–‡ç»ã€å–®ç¯‡è«–æ–‡ã€æ·±åº¦å ±å°ä»¥åŠæ–‡å­¸ä½œå“çš„é–±è®€å’Œè¨è«–ï¼Œå”åŠ©å­¸ç”Ÿå±•é–‹åæ€å·¥ä½œã€‚å¼•å°å­¸ç”Ÿçªç ´ç¿’ä»¥ä¸ºå¸¸ã€æ—¥ç”¨è€Œä¸è‡ªçŸ¥çš„æ—¥å¸¸æ¨¡å¼ï¼Œèµ°ä¸Šè‡ªæˆ‘æ¢ç´¢ä¹‹è·¯ã€‚è‹¥æ­¤ï¼Œæˆ–å¯é€šå‘æ¾„æ˜ä¹‹æ™ºï¼Œå¦¥å–„å®‰é “ä¸»é«”ï¼ˆå€‹äººï¼‰-æ•´é«”ï¼ˆäººæ–‡ä¸–ç•Œï¼‰-å¤©åœ°ï¼ˆè‡ªç„¶ä¸–ç•Œï¼‰é€™ä¸‰å…ƒç¶­åº¦ã€‚"", grading: "å°šç„¡è©³ç´°è³‡æ–™" },
            { id: "A2805", name: "è‡ºç£å¤å…¸è©©é¸è®€", teacher: "æ–½æŸ”å¦¤", credit: 3, info: "æœ¬èª²ç¨‹ä»¥è‡ºç£å¤å…¸è©©ç‚ºä¸»è»¸ï¼Œé¸å–æ˜æ¸…ä»¥é™çš„æ¼¢è©©äººæ‰€ä½œï¼Œäº†è§£è‡ºç£å¤å…¸è©©ä½œçš„ç™¼å±•ï¼Œä¸¦ç”±æ­¤ç†è§£å…¶äººæ‰€è™•çš„æ™‚ä»£èˆ‡ç›¸é—œè­°é¡Œã€‚æ–¼é–±è®€é‘‘è³çš„éç¨‹ä¸­ï¼Œä½¿å¾—å­¸ç”Ÿå¾—ä»¥é ˜ç•¥å¤å…¸è©©ä¹‹åˆ†æèˆ‡é‘‘è³ï¼Œå¼·åŒ–äººæ–‡ç´ é¤Šï¼Œä¸¦ç”±æ­¤åŠ æ·±å°æ–¼è‡ºç£æœ¬åœŸçš„ç†è§£ï¼Œå …å®šè‡ªæˆ‘æ–‡åŒ–åƒ¹å€¼ï¼Œç«‹è¶³æ–¼è‡ºç£æ–‡å­¸ã€æ­·å²çš„ç†è§£ï¼Œä¹Ÿç”±èƒŒæ™¯å„ç•°çš„è©©äººè©©ä½œä¹‹é–±è®€ç†è§£ï¼ŒåŸ¹é¤Šå°Šé‡æ¬£è³å¤šå…ƒæ–‡åŒ–çš„æ ¹åŸºã€‚", grading: "å°šç„¡è©³ç´°è³‡æ–™" }
            
        ],
        "å…¬æ°‘èˆ‡ç¤¾æœƒæ¢ç©¶": [
            { id: "A2846", name: "é†«å­¸èˆ‡æ³•å¾‹", teacher: "é™³ä»²éš†", credit: 2, info: "æ³•å¾‹å¯¦å‹™", grading: "æœŸæœ«100%" }
        ]
    },
    "å¤šå…ƒ": {
        "è‡ªç„¶ç§‘å­¸é ˜åŸŸ": [
            { id: "B1234", name: "ç’°å¢ƒä¿è­·", teacher: "ææ˜", credit: 2, info: "ç”Ÿæ…‹ä»‹ç´¹", grading: "å¿ƒå¾—100%" }
        ]
    }
};

const csvUrl = "https://docs.google.com/spreadsheets/d/e/2PACX-1vR8cTxUPOSQA1ypJytbZ01-CX5qXM-iXExvbaBOpWATCade5xf3WYsKLrdhbrBOAiegZiefn97HgGlv/pub?gid=313985456&single=true&output=csv";
let allReviews = [];

async function loadReviews() {
    try {
        const res = await fetch(csvUrl);
        const text = await res.text();
        const rows = text.split('\n').map(r => r.split(/,(?=(?:(?:[^"]*"){2})*[^"]*$)/)).slice(1);
        allReviews = rows.map(row => ({
            name: (row[5] || row[13] || row[21] || "").replace(/"/g, ''),
            overall: row[7] || row[15] || row[23] || "?",
            sweet: row[8] || row[16] || row[24] || "?",
            cool: row[9] || row[17] || row[25] || "?",
            comment: (row[12] || row[20] || row[28] || "").replace(/"/g, '')
        }));
    } catch(e) { console.error("å¿ƒå¾—è¼‰å…¥å¤±æ•—", e); }
}

let curMain = "";
let curSub = "";

function showLayer2(main) {
    curMain = main;
    switchLayer(2);
    document.getElementById('layer2_title').innerText = "é ˜åŸŸé¸æ“‡ï¼š" + main;
    const container = document.getElementById('sub_cat_container');
    container.innerHTML = Object.keys(courseData[main]).map(sub => 
        `<button class="btn_home" onclick="showLayer3('${sub}')">${sub}</button>`
    ).join('');
}

function showLayer3(sub) {
    curSub = sub;
    switchLayer(3);
    document.getElementById('layer3_title').innerText = "èª²ç¨‹æ¸…å–®ï¼š" + sub;
    const container = document.getElementById('course_list_container');
    
    // å–å¾—è©²é ˜åŸŸä¸‹çš„æ‰€æœ‰èª²ç¨‹è³‡æ–™
    const courses = courseData[curMain][sub] || [];
    
    // æ¸²æŸ“æŒ‰éˆ•ï¼šåƒè€ƒ MMC æ ¼å¼ -> èª²ç¨‹ä»£ç¢¼ï½œèª²ç¨‹åç¨± (è€å¸«åå­—)
    container.innerHTML = courses.map(c => `
        <div>
            <input type="button" class="btn_course" 
                   value="${c.id}ï½œ${c.name} (${c.teacher})" 
                   onclick="showFinal('${c.name}')">
        </div>
    `).join('');
}

function showFinal(cName) {
    switchLayer(4);
    const course = courseData[curMain][curSub].find(c => c.name === cName);
    
    // é¡¯ç¤ºèª²ç¨‹åŸºæœ¬è³‡è¨Š
    document.getElementById('final_title').innerText = `${course.id} ï½œ ${cName}`;
    document.getElementById('course_info_box').innerHTML = `
        <div class="label_info">${course.teacher} | ${course.credit}å­¸åˆ†</div>
        <div class="label_comment" style="background:#f9f9f9"><b>ç°¡ä»‹ï¼š</b>${course.info}<br><b>è©•åˆ†ï¼š</b>${course.grading}</div>
    `;

    const reviews = allReviews.filter(r => r.name === cName);
    const rContainer = document.getElementById('reviews_container');

    // --- é€™è£¡å°±æ˜¯ä½ è¦åŠ å…¥çš„åˆ¤æ–·é‚è¼¯ ---
    if (reviews.length > 0) {
        // å¦‚æœæœ‰å¿ƒå¾—ï¼Œå°±é¡¯ç¤ºå¿ƒå¾—åˆ—è¡¨
        rContainer.innerHTML = reviews.map(r => `
            <div class="label_comment">
                <b>å­¸æœŸ ï½œ â­${r.overall} ï½œ ğŸ¬${r.sweet} ï½œ â„ï¸${r.cool}</b><br><br>
                ${r.comment.replace(/\n/g, '<br>')}
            </div>
        `).join('');
    } else {
        // å¦‚æœæ²’æœ‰å¿ƒå¾—ï¼Œå°±é¡¯ç¤ºä½ å¾®èª¿çš„é‚£æ®µæº«é¦¨æç¤º
        rContainer.innerHTML = `
            <div class="label_info" style="background-color: #fddb69; margin-top: 20px;">
                ç›®å‰å°šç„¡å¿ƒå¾—ï¼Œæ­¡è¿å¤§å®¶æŠ•ç¨¿ï¼âœ¨<br>
                <small>(é»æ“Šé¦–é ä¸‹æ–¹ç²‰ç´…è‰²æŒ‰éˆ•å³å¯åˆ†äº«æ‚¨çš„ç¶“é©—)</small>
            </div>`;
    }
}

function switchLayer(n) {
    document.querySelectorAll('.layer').forEach(l => l.classList.remove('active'));
    document.getElementById('layer' + n).classList.add('active');
    window.scrollTo(0, 0); // åˆ‡æ›æ™‚è‡ªå‹•å›åˆ°æœ€ä¸Šæ–¹
}

loadReviews();
</script>

</body>
</html>
