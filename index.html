<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=2.0" />
    <title>é•·åºšé†«å­¸ç³»é€šè­˜åˆ†äº«å€</title>
    <style>

        /* æ ¸å¿ƒ MMC é¢¨æ ¼åŸºç¤ */
        body { background-color: #eeeeee; font-family: sans-serif; display: flex; flex-direction: column; align-items: center; padding: 20px; margin: 0; }
        #index_frame { width: 100%; max-width: 600px; text-align: center; }

        /* æ¨™é¡Œèˆ‡è³‡è¨Šæ¡† (Neo-Brutalism Style) */
        .label_title { font-size: 25px; font-weight: bold; width: 100%; line-height: 24px; text-align: center; color: black; background-color: #87e967; padding: 15px; border-radius: 10px; border: 3px solid #000; display: block; box-sizing: border-box; margin-bottom: 10px; }
        .label_info { font-size: 18px; font-weight: bold; width: 100%; text-align: center; color: black; background-color: #fddb69; padding: 10px; border-radius: 10px; border: 3px solid #000; margin: 10px 0; display: block; box-sizing: border-box; }

        /* MMC å®¹å™¨æ¨£å¼ */
        .index_choosebox { margin: 10px auto; background-color: #ffffff; padding: 15px; border-radius: 10px; border: 3px solid #000; display: flex; flex-direction: column; align-items: center; box-sizing: border-box; width: 100%; }

        /* æ¨™æº–æŒ‰éˆ•æ¨£å¼ (Layer 1 & 2 ä½¿ç”¨) */
        .btn_home { appearance: none; width: 100%; font-size: 18px; font-weight: bold; text-align: center; color: black; background-color: #7edcfc; border-radius: 10px; padding: 12px; border: 3px solid #000; cursor: pointer; box-shadow: 3px 3px 0px #29c6fa; margin: 8px 0; transition: 0.1s; white-space: pre-wrap; }
        .btn_home:active { transform: translate(2px, 2px); box-shadow: none; }

        /* èª²ç¨‹å°ˆç”¨æŒ‰éˆ•æ¨£å¼ (Layer 3 å°ˆç”¨ï¼Œåƒè€ƒ MMC å¼·èª¿èª²ç¨‹è³‡è¨Š) */
        .btn_course { 
            appearance: none; width: 100%; max-width: 480px; font-size: 18px; font-weight: bold; 
            text-align: center; color: black; background-color: #7edcfc; border-radius: 10px; 
            padding: 12px; border: 3px solid #000; cursor: pointer; box-shadow: 3px 3px 0px #29c6fa; 
            margin: 10px 0; white-space: pre-wrap; transition: 0.1s; display: block;
        }
        .btn_course:active { transform: translate(2px, 2px); box-shadow: none; }

        /* åŠŸèƒ½æŒ‰éˆ• (æˆ‘è¦è²¢ç»æ¨£å¼) */
        .btn_contribution { background-color: #FFD2D7; box-shadow: 3px 3px 0px #d06f79; width: 100%; font-size: 18px; font-weight: bold; padding: 12px; border-radius: 10px; border: 3px solid #000; cursor: pointer; margin-bottom: 15px; display: block; text-decoration: none; color: black; box-sizing: border-box; }

        /* å¿ƒå¾—é¡¯ç¤ºå€ (å¥—ç”¨å­¸é•· label_comment) */
        .label_comment { font-size: 16px; width: 100%; background-color: #ffffff; border-radius: 10px; padding: 15px; border: 3px solid #000; margin-bottom: 15px; text-align: left; box-sizing: border-box; line-height: 1.6; }

        /* é›™é‡å°èˆªçµ„ */
        .nav_group { display: flex; gap: 10px; width: 100%; margin-top: 5px; margin-bottom: 5px; box-sizing: border-box; }
        .nav_group .btn_home { font-size: 16px; background-color: #bbb; box-shadow: 2px 2px 0#777; flex: 1; margin: 0; }
        .nav_group .btn_home_active { background-color: #7edcfc; box-shadow: 2px 2px 0#29c6fa; }

        /* çµæ§‹å±¤ç´šæ§åˆ¶ */
        .layer { display: none; width: 100%; flex-direction: column; align-items: center; }
        .active { display: flex; }

        /* éŸ¿æ‡‰å¼å¾®èª¿ */
        @media screen and (max-width:600px){
            #index_frame { width: 95%; }
            .btn_course, .btn_home, .label_title, .label_info, .index_choosebox, .btn_contribution, .label_comment { width: 100% !important; }
        }
        
    </style>
</head>
    
<body>

<div id="index_frame">
    <label class="label_title">é•·åºšé†«å­¸ç³»é€šè­˜åˆ†äº«å€ ğŸ“š</label>

    <div id="layer1" class="layer active">
        <label class="label_info">è«‹é¸æ“‡é€šè­˜é¡åˆ¥</label>
        <div class="index_choosebox">
            <button class="btn_home" onclick="showLayer2('æ ¸å¿ƒ')">æ ¸å¿ƒé€šè­˜</button>
            <button class="btn_home" onclick="showLayer2('å¤šå…ƒ')">å¤šå…ƒé€šè­˜</button>
        </div>
        <a href="https://forms.gle/6yTjFRWBnxJTjLMT8" target="_blank" class="btn_contribution">âœï¸ æˆ‘è¦æŠ•ç¨¿å¿ƒå¾—</a>
    </div>

    <div id="layer2" class="layer">
        <div class="nav_group">
            <button class="btn_home" onclick="switchLayer(1)">â¬…ï¸ è¿”å›é¦–é </button>
        </div>
        <label id="layer2_title" class="label_info"></label>
        <div class="index_choosebox" id="sub_cat_container"></div>
    </div>

    <div id="layer3" class="layer">
        <div class="nav_group">
            <button class="btn_home" onclick="switchLayer(2)">â¬…ï¸ è¿”å›é ˜åŸŸ</button>
            <button class="btn_home btn_home_active" onclick="switchLayer(1)">ğŸ  å›é¦–é </button>
        </div>
        <label id="layer3_title" class="label_info"></label>
        <div class="index_choosebox" id="course_list_container"></div>
        <div class="nav_group">
            <button class="btn_home" onclick="switchLayer(2)">â¬…ï¸ è¿”å›é ˜åŸŸ</button>
            <button class="btn_home btn_home_active" onclick="switchLayer(1)">ğŸ  å›é¦–é </button>
        </div>
    </div>

    <div id="layer4" class="layer">
        <div class="nav_group">
            <button class="btn_home" onclick="switchLayer(3)">â¬…ï¸ è¿”å›åˆ—è¡¨</button>
            <button class="btn_home btn_home_active" onclick="switchLayer(1)">ğŸ  å›é¦–é </button>
        </div>
        <label id="final_title" class="label_title"></label>
        <div id="course_info_box" style="width: 100%;"></div>
        <div id="reviews_container" style="width: 100%;"></div>
        <div class="nav_group">
            <button class="btn_home" onclick="switchLayer(3)">â¬…ï¸ è¿”å›åˆ—è¡¨</button>
            <button class="btn_home btn_home_active" onclick="switchLayer(1)">ğŸ  å›é¦–é </button>
        </div>
    </div>

    <p style="font-size: 12px; color: #888; margin-top: 30px;">Coded by huangboxun12 & AI Assistant(Gemini)<br>æœ€å¾Œæ›´æ–°: 2026/02/09</p>
</div>

<script>
// --- é è¼‰èª²ç¨‹è³‡æ–™ (è«‹å°‡æ‚¨çš„ Sheet è³‡æ–™å¡«å…¥æ­¤è™•) ---
// --- é è¼‰èª²ç¨‹è³‡æ–™ (å·²ä¿®å¾©å¼•è™Ÿè¡çª) ---
const courseData = {
    "æ ¸å¿ƒ": {
        "è—è¡“èˆ‡äººæ–‡æ€ç¶­": [
            { 
                id: "A2826", 
                name: "æ­ŒåŠ‡èˆ‡æ­ŒåŠ‡é™¢", 
                teacher: "æ´ªäºæ·³", 
                credit: 3, 
                info: "æ­ŒåŠ‡ç‚ºä¸€é–€çµåˆéŸ³æ¨‚ã€æˆ²åŠ‡ã€èˆè¹ˆã€æœè£ã€è¡¨æ¼”è—è¡“ã€èˆ‡å»ºç¯‰çš„ç¶œåˆè—è¡“ã€‚æœ¬èª²ç¨‹å°‡å¾æ­ŒåŠ‡çš„ç™¼å±•éç¨‹ä¸­ï¼Œä»‹ç´¹ç•¶æ™‚æ‰€é©åˆçš„æ¼”å‡ºå ´æ‰€ã€‚", 
                grading: "ä¸€ã€èª²å ‚è¡¨ç¾ 20% äºŒã€å°çµ„è¨è«– 20% ä¸‰ã€å£é ­å ±å‘Š 20% å››ã€æ›¸é¢å ±å‘Š 40%" 
            },
            { 
                id: "A2827", 
                name: "ç¾ä»£è©©èˆ‡ç•¶ä»£æ–‡åŒ–", 
                teacher: "åŠ‰å¾·ç²", 
                credit: 3, 
                info: "ç¾ä»£è©©è‡ªäº”å››æ–‡å­¸è®Šé©ä»¥ä¾†é¢¨æƒ…è¬ç¨®ï¼Œæœ¬èª²ç¨‹é€éåå®¶ä½œå“è¬›æˆèˆ‡åˆ†æï¼Œå¼•å°å­¸ç”ŸæŒæ¡ç¾ä»£è©©ä¹‹é¢è²Œï¼ŒåŸ¹é¤Šæ¬£è³èƒ½åŠ›ã€‚", 
                grading: "å°šç„¡è©³ç´°è³‡æ–™" 
            },
            { 
                id: "A2846", 
                name: "å¯“è¨€-ç¶“å…¸èˆ‡å¤šå…ƒæ€ç¶­", 
                teacher: "éŸ“å­¸å®", 
                credit: 3, 
                info: "å¯“è¨€æ˜¯ä½œè€…å¦æœ‰å¯„æ‰˜çš„æ•…äº‹ã€‚æœ¬èª²ç¨‹è©¦åœ–é€éä»‹ç´¹å…ˆç§¦ä»¥ä¾†å„æœŸçš„å¯“è¨€ï¼Œä»¥æ˜ç­å¤å“²æ‰€è¦å‚³é”çµ¦æˆ‘å€‘çš„æ™ºæ…§ã€‚", 
                grading: "å°šç„¡è©³ç´°è³‡æ–™" 
            },
            { 
                id: "A2499", 
                name: "å€«ç†èˆ‡ç¾å­¸ï¼šé›»å½±èˆ‡æˆ²åŠ‡ä¸­çš„èå£«æ¯”äº", 
                teacher: "é„­æƒ èŠ³", 
                credit: 3, 
                info: "æœ¬èª²ç¨‹åŸ·è¡Œæ•™è‚²éƒ¨æ•™å­¸å¯¦è¸ç ”ç©¶è¨ˆç•«ã€‚èª²ç¨‹çµåˆèå£«æ¯”äºæ–‡å­¸èˆ‡è¡¨é”è—è¡“æ²»ç™‚ï¼Œæå‡æƒ…ç·’å¥åº·èˆ‡è‡ªæˆ‘è¦ºå¯Ÿã€‚", 
                grading: "å°šç„¡è©³ç´°è³‡æ–™" 
            },
            { 
                id: "A2500", 
                name: "æ­ç¾æˆ²åŠ‡", 
                teacher: "é»ƒå°¹ç‘©", 
                credit: 3, 
                info: "é€éå°æ­ç¾æˆ²åŠ‡çš„ä»‹ç´¹ã€ç¶“å…¸åŠ‡æœ¬é–±è®€åŠå½±åƒè³‡æ–™ï¼Œå¼•é ˜å­¸ç”Ÿèªè­˜æ­ç¾æˆ²åŠ‡é¢¨æ ¼åŠå…¶çµ„æˆæˆä»½ã€‚", 
                grading: "å°šç„¡è©³ç´°è³‡æ–™" 
            },
            { 
                id: "A2501", 
                name: "åŒ—ç¾å°èªªã€æŠ€è—èˆ‡æ€§åˆ¥è§’è‰²", 
                teacher: "è‘‰ç‰æ…§", 
                credit: 3, 
                info: "ç”±å…­ã€‡è‡³ä¸ƒã€‡å¹´ä»£å¥³æ€§ä¸»ç¾©è«–è¿°åˆ‡å…¥ï¼Œæ¢è¨å¥³æ€§åŒ–æŠ€è—ï¼ˆå¦‚ç·¨ç¹”ã€çƒ¹é£ªï¼‰åœ¨ç¤¾æœƒè§’è‰²èˆ‡æˆåŠŸé€”å¾‘ä¸­çš„æ¼”è®Šã€‚", 
                grading: "å°šç„¡è©³ç´°è³‡æ–™" 
            },
            { 
                id: "A2847", 
                name: "å“²å­¸èˆ‡æ–‡åŒ–", 
                teacher: "é‚¸å½¥", 
                credit: 3, 
                info: "å“²å­¸å³ç‚ºæ„›æ™ºæ…§ä¹‹å­¸ã€‚æœ¬èª²ç¨‹å‹™æ±‚æ“´å¤§æ–‡åŒ–è¦–é‡çš„å»£åº¦ï¼Œä¸¦æŠŠæ¡å“²å­¸çš„æ•´é«”æ€§å’Œæœ€çµ‚ç›®çš„ï¼Œå”åŠ©å­¸ç”Ÿå±•é–‹åæ€ã€‚", 
                grading: "å°šç„¡è©³ç´°è³‡æ–™" 
            },
            { 
                id: "A2805", 
                name: "è‡ºç£å¤å…¸è©©é¸è®€", 
                teacher: "æ–½æŸ”å¦¤", 
                credit: 3, 
                info: "ä»¥è‡ºç£å¤å…¸è©©ç‚ºä¸»è»¸ï¼Œäº†è§£è‡ºç£å¤å…¸è©©ä½œçš„ç™¼å±•èˆ‡ç›¸é—œæ™‚ä»£è­°é¡Œï¼Œå¼·åŒ–äººæ–‡ç´ é¤Šä¸¦åŠ æ·±å°æœ¬åœŸçš„ç†è§£ã€‚", 
                grading: "å°šç„¡è©³ç´°è³‡æ–™" 
            }
        ],
        "å…¬æ°‘èˆ‡ç¤¾æœƒæ¢ç©¶": [
            { id: "A2846", name: "é†«å­¸èˆ‡æ³•å¾‹", teacher: "é™³ä»²éš†", credit: 2, info: "æ¢è¨é†«ç™‚æ³•å¾‹åŸºç¤å¯¦å‹™ã€‚", grading: "æœŸæœ«100%" }
        ]
    },
    "å¤šå…ƒ": {
        "è‡ªç„¶ç§‘å­¸é ˜åŸŸ": [
            { id: "B1234", name: "ç’°å¢ƒä¿è­·", teacher: "ææ˜", credit: 2, info: "ç”Ÿæ…‹ç’°å¢ƒèˆ‡æ°¸çºŒç™¼å±•ä»‹ç´¹ã€‚", grading: "å¿ƒå¾—100%" }
        ]
    }
};

const csvUrl = "https://docs.google.com/spreadsheets/d/e/2PACX-1vR8cTxUPOSQA1ypJytbZ01-CX5qXM-iXExvbaBOpWATCade5xf3WYsKLrdhbrBOAiegZiefn97HgGlv/pub?gid=313985456&single=true&output=csv";
let allReviews = [];

async function loadReviews() {
    try {
        const res = await fetch(csvUrl);
        const text = await res.text();
        const rows = text.split('\n').map(r => r.split(/,(?=(?:(?:[^"]*"){2})*[^"]*$)/)).slice(1);
        allReviews = rows.map(row => ({
            name: (row[5] || row[13] || row[21] || "").replace(/"/g, ''),
            overall: row[7] || row[15] || row[23] || "?",
            sweet: row[8] || row[16] || row[24] || "?",
            cool: row[9] || row[17] || row[25] || "?",
            comment: (row[12] || row[20] || row[28] || "").replace(/"/g, '')
        }));
    } catch(e) { console.error("å¿ƒå¾—è¼‰å…¥å¤±æ•—", e); }
}

let curMain = "";
let curSub = "";

function showLayer2(main) {
    curMain = main;
    switchLayer(2);
    document.getElementById('layer2_title').innerText = "é ˜åŸŸé¸æ“‡ï¼š" + main;
    const container = document.getElementById('sub_cat_container');
    container.innerHTML = Object.keys(courseData[main]).map(sub => 
        `<button class="btn_home" onclick="showLayer3('${sub}')">${sub}</button>`
    ).join('');
}

function showLayer3(sub) {
    curSub = sub;
    switchLayer(3);
    document.getElementById('layer3_title').innerText = "èª²ç¨‹æ¸…å–®ï¼š" + sub;
    const container = document.getElementById('course_list_container');
    
    // å–å¾—è©²é ˜åŸŸä¸‹çš„æ‰€æœ‰èª²ç¨‹è³‡æ–™
    const courses = courseData[curMain][sub] || [];
    
    // æ¸²æŸ“æŒ‰éˆ•ï¼šåƒè€ƒ MMC æ ¼å¼ -> èª²ç¨‹ä»£ç¢¼ï½œèª²ç¨‹åç¨± (è€å¸«åå­—)
    container.innerHTML = courses.map(c => `
        <div>
            <input type="button" class="btn_course" 
                   value="${c.id}ï½œ${c.name} (${c.teacher})" 
                   onclick="showFinal('${c.name}')">
        </div>
    `).join('');
}

function showFinal(cName) {
    switchLayer(4);
    const course = courseData[curMain][curSub].find(c => c.name === cName);
    
    // é¡¯ç¤ºèª²ç¨‹åŸºæœ¬è³‡è¨Š
    document.getElementById('final_title').innerText = `${course.id} ï½œ ${cName}`;
    document.getElementById('course_info_box').innerHTML = `
        <div class="label_info">${course.teacher} | ${course.credit}å­¸åˆ†</div>
        <div class="label_comment" style="background:#f9f9f9">
            <b>ğŸ“– èª²ç¨‹ç°¡ä»‹ï¼š</b><br>${course.info.replace(/\n/g, '<br>')}<br><br>
            <b>ğŸ“ è©•åˆ†æ–¹å¼ï¼š</b><br>${course.grading.replace(/\n/g, '<br>')}
        </div>
    `;

    const reviews = allReviews.filter(r => r.name === cName);
    const rContainer = document.getElementById('reviews_container');

    // --- é€™è£¡å°±æ˜¯ä½ è¦åŠ å…¥çš„åˆ¤æ–·é‚è¼¯ ---
    if (reviews.length > 0) {
        // å¦‚æœæœ‰å¿ƒå¾—ï¼Œå°±é¡¯ç¤ºå¿ƒå¾—åˆ—è¡¨
        rContainer.innerHTML = reviews.map(r => `
            <div class="label_comment">
                <b>å­¸æœŸ ï½œ â­${r.overall} ï½œ ğŸ¬${r.sweet} ï½œ â„ï¸${r.cool}</b><br><br>
                ${r.comment.replace(/\n/g, '<br>')}
            </div>
        `).join('');
    } else {
        // å¦‚æœæ²’æœ‰å¿ƒå¾—ï¼Œå°±é¡¯ç¤ºä½ å¾®èª¿çš„é‚£æ®µæº«é¦¨æç¤º
        rContainer.innerHTML = `
            <div class="label_info" style="background-color: #fddb69; margin-top: 20px;">
                ç›®å‰å°šç„¡å¿ƒå¾—ï¼Œæ­¡è¿å¤§å®¶æŠ•ç¨¿ï¼âœ¨<br>
                <small>(é»æ“Šé¦–é ä¸‹æ–¹ç²‰ç´…è‰²æŒ‰éˆ•å³å¯åˆ†äº«æ‚¨çš„ç¶“é©—)</small>
            </div>`;
    }
}

function switchLayer(n) {
    document.querySelectorAll('.layer').forEach(l => l.classList.remove('active'));
    document.getElementById('layer' + n).classList.add('active');
    window.scrollTo(0, 0); // åˆ‡æ›æ™‚è‡ªå‹•å›åˆ°æœ€ä¸Šæ–¹
}

loadReviews();
</script>

</body>
</html>
